---
phase: 01-app-shell-hotkey-floating-panel
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - QuickTask/QuickTask.xcodeproj/project.pbxproj
  - QuickTask/QuickTask/App/QuickTaskApp.swift
  - QuickTask/QuickTask/App/AppDelegate.swift
  - QuickTask/QuickTask/Info.plist
  - QuickTask/QuickTask/Views/ContentView.swift
autonomous: true
requirements:
  - SHELL-02

must_haves:
  truths:
    - "App launches with no Dock icon visible"
    - "App compiles and runs without errors in Xcode"
    - "KeyboardShortcuts and Defaults SPM packages resolve successfully"
  artifacts:
    - path: "QuickTask/QuickTask/App/QuickTaskApp.swift"
      provides: "@main app entry point with AppDelegate adapter"
      contains: "@main"
    - path: "QuickTask/QuickTask/App/AppDelegate.swift"
      provides: "AppDelegate class with applicationDidFinishLaunching"
      contains: "class AppDelegate"
    - path: "QuickTask/QuickTask/Info.plist"
      provides: "LSUIElement = YES to suppress Dock icon"
      contains: "LSUIElement"
  key_links:
    - from: "QuickTask/QuickTask/App/QuickTaskApp.swift"
      to: "QuickTask/QuickTask/App/AppDelegate.swift"
      via: "@NSApplicationDelegateAdaptor"
      pattern: "NSApplicationDelegateAdaptor.*AppDelegate"
---

<objective>
Create the Xcode project for QuickTask, add SPM dependencies (KeyboardShortcuts 2.4.0, Defaults 9.0.6), configure Info.plist for menu bar agent behavior (LSUIElement), and set up the AppDelegate-based app lifecycle.

Purpose: Establish the project scaffold that all subsequent plans build on. The LSUIElement configuration and AppDelegate pattern are foundational — getting these wrong forces a painful restructuring later.

Output: A compilable, runnable Xcode project with no Dock icon, correct deployment target (macOS 14.0), and both SPM dependencies resolved.
</objective>

<execution_context>
@/home/rob/.claude/get-shit-done/workflows/execute-plan.md
@/home/rob/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/research/ARCHITECTURE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Xcode project and configure SPM dependencies</name>
  <files>
    QuickTask/QuickTask.xcodeproj/project.pbxproj
    QuickTask/QuickTask/Info.plist
  </files>
  <action>
Create a new Xcode macOS App project named "QuickTask" at the repository root using `swift package init` is NOT appropriate here — this is an Xcode `.xcodeproj` app, not a pure SPM package. Use `xcodebuild` or create the project structure manually:

1. Create the directory structure:
   ```
   QuickTask/
   ├── QuickTask.xcodeproj/
   │   └── project.pbxproj
   └── QuickTask/
       ├── App/
       │   ├── QuickTaskApp.swift
       │   └── AppDelegate.swift
       ├── Views/
       │   └── ContentView.swift
       ├── Info.plist
       └── Resources/
           └── Assets.xcassets/
               └── Contents.json
   ```

2. Generate `project.pbxproj` with:
   - Bundle identifier: `com.quicktask.app` (or similar)
   - Deployment target: macOS 14.0
   - Swift Language Version: 6
   - SPM dependencies:
     - `https://github.com/sindresorhus/KeyboardShortcuts` — Up to Next Major from 2.4.0
     - `https://github.com/sindresorhus/Defaults` — Up to Next Major from 9.0.6
   - Build setting: `INFOPLIST_FILE = QuickTask/Info.plist`
   - Build setting: `PRODUCT_BUNDLE_IDENTIFIER = com.quicktask.app`

3. Create `Info.plist` with:
   - `LSUIElement` = `YES` (Boolean true) — suppresses Dock icon per SHELL-02
   - `CFBundleName` = `QuickTask`
   - `CFBundleDisplayName` = `QuickTask`
   - Standard macOS app keys (CFBundleIdentifier, CFBundleVersion, etc.)

IMPORTANT: Since creating a full pbxproj by hand is extremely error-prone (it's a 500+ line structured file with UUIDs), the practical approach is:
- Use `xcodegen` if available, OR
- Create a minimal `Package.swift` that declares an executable target with the app structure, then use `swift build` to verify compilation, OR
- Create the project via command-line Xcode tools: `xcodebuild -create-project` is not a real command, so instead create a `project.yml` for XcodeGen or use the `swift package init --type executable` approach and add an `Info.plist` manually.

The MOST RELIABLE approach for CLI-based project creation: Use Swift Package Manager with executable target, then layer on the Info.plist and entitlements. The app entry point uses `@main` on the App struct, which works with SPM executables targeting macOS.

Create a `Package.swift` at `QuickTask/Package.swift`:
- name: "QuickTask"
- platforms: [.macOS(.v14)]
- products: [.executable(name: "QuickTask", targets: ["QuickTask"])]
- dependencies: KeyboardShortcuts from 2.4.0, Defaults from 9.0.0
- target "QuickTask" with path "QuickTask", dependencies on KeyboardShortcuts and Defaults
- swiftLanguageVersions: [.v6] if supported, otherwise use swift-tools-version 6.0

Note: SPM executable with @main App struct works for macOS SwiftUI apps. The Info.plist needs to be embedded via build settings or placed alongside the executable.
  </action>
  <verify>
Run `cd QuickTask && swift build` — project compiles with zero errors. Both KeyboardShortcuts and Defaults packages resolve and download.
  </verify>
  <done>
Xcode/SPM project exists at QuickTask/, compiles successfully, both SPM dependencies resolve. Info.plist contains LSUIElement = YES.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create AppDelegate and app entry point with LSUIElement behavior</name>
  <files>
    QuickTask/QuickTask/App/QuickTaskApp.swift
    QuickTask/QuickTask/App/AppDelegate.swift
    QuickTask/QuickTask/Views/ContentView.swift
  </files>
  <action>
Create the app entry point and AppDelegate:

1. `QuickTaskApp.swift`:
   - Use `@main` attribute on the App struct
   - Declare `@NSApplicationDelegateAdaptor(AppDelegate.self) var appDelegate`
   - Body returns a minimal `Settings { EmptyView() }` scene (or `WindowGroup` that is immediately hidden) — the real UI lives in the NSPanel created in Plan 02. For now, just have a valid scene body. Do NOT use `MenuBarExtra` per research decisions.

2. `AppDelegate.swift`:
   - Class `AppDelegate: NSObject, NSApplicationDelegate`
   - `applicationDidFinishLaunching(_:)` — for now, just set `NSApp.setActivationPolicy(.accessory)` to reinforce the no-Dock-icon behavior. This is belt-and-suspenders with LSUIElement. Print a log message confirming launch.
   - This class will be extended in Plan 02 to hold the NSStatusItem (strong reference) and PanelManager.

3. `ContentView.swift`:
   - Minimal SwiftUI view with `Text("QuickTask")` centered. This is a placeholder that will be replaced with the actual task capture UI in Phase 2. It will be hosted inside the NSPanel in Plan 02.
   - Set frame to approximately 400x300 to simulate final panel size.

CRITICAL per research: AppDelegate MUST be a class (not struct), MUST inherit NSObject, MUST conform to NSApplicationDelegate. The `@NSApplicationDelegateAdaptor` wiring ensures it is created and retained by SwiftUI's app lifecycle.
  </action>
  <verify>
Run `cd QuickTask && swift build && swift run QuickTask` (or build and run). App launches with no Dock icon. Console shows the launch log message. App appears only in Activity Monitor, not in the Dock. Force-quit via Activity Monitor or Ctrl+C.
  </verify>
  <done>
App launches as a menu bar agent (no Dock icon). AppDelegate.applicationDidFinishLaunching fires. ContentView exists as placeholder. SHELL-02 is satisfied.
  </done>
</task>

</tasks>

<verification>
1. `swift build` in QuickTask/ completes with zero errors
2. KeyboardShortcuts and Defaults packages are listed in Package.resolved
3. Running the app shows no Dock icon
4. AppDelegate.applicationDidFinishLaunching is called (verify via console output)
5. Info.plist contains LSUIElement = YES
</verification>

<success_criteria>
- Compilable project with both SPM dependencies resolved
- App runs as menu bar agent with no Dock icon (SHELL-02)
- AppDelegate is wired and fires on launch
- ContentView placeholder exists for NSPanel hosting in Plan 02
</success_criteria>

<output>
After completion, create `.planning/phases/01-app-shell-hotkey-floating-panel/01-01-SUMMARY.md`
</output>
