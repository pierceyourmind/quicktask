---
phase: 03-settings-launch-at-login-v1-polish
plan: "02"
type: execute
wave: 1
depends_on: []
files_modified:
  - QuickTask/Sources/Views/TaskListView.swift
  - QuickTask/Sources/Panel/FloatingPanel.swift
  - QuickTask/Sources/Panel/PanelManager.swift
autonomous: true
requirements: [SETT-01, SETT-02]

must_haves:
  truths:
    - "An empty task list shows an encouraging placeholder instead of blank space"
    - "The panel opens with a smooth animation (not an instant snap)"
    - "The panel closes with a smooth animation (not an instant snap)"
  artifacts:
    - path: "QuickTask/Sources/Views/TaskListView.swift"
      provides: "Empty state overlay when no tasks exist"
      contains: "ContentUnavailableView"
    - path: "QuickTask/Sources/Panel/FloatingPanel.swift"
      provides: "Animation behavior configuration"
      contains: "animationBehavior"
  key_links:
    - from: "QuickTask/Sources/Views/TaskListView.swift"
      to: "QuickTask/Sources/Store/TaskStore.swift"
      via: "store.tasks.isEmpty check for overlay"
      pattern: "store\\.tasks\\.isEmpty"
    - from: "QuickTask/Sources/Panel/FloatingPanel.swift"
      to: "PanelManager show/hide calls"
      via: "animationBehavior applied before orderFront/orderOut"
      pattern: "animationBehavior"
---

<objective>
Add an encouraging empty state to the task list and smooth open/close animations to the floating panel.

Purpose: These polish items complete the v1 experience -- an empty list should feel inviting (not broken), and panel transitions should feel deliberate (not jarring). Success criteria 4 and 5 from the phase goal.

Output: ContentUnavailableView overlay on empty task list, smooth panel animation via animationBehavior.
</objective>

<execution_context>
@/home/rob/.claude/get-shit-done/workflows/execute-plan.md
@/home/rob/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-settings-launch-at-login-v1-polish/03-RESEARCH.md
@QuickTask/Sources/Views/TaskListView.swift
@QuickTask/Sources/Panel/FloatingPanel.swift
@QuickTask/Sources/Panel/PanelManager.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ContentUnavailableView empty state overlay to TaskListView</name>
  <files>
    QuickTask/Sources/Views/TaskListView.swift
  </files>
  <action>
Modify `TaskListView.swift` to show an encouraging empty state when there are no tasks.

Add an `.overlay` modifier to the `List`:
```swift
.overlay {
    if store.tasks.isEmpty {
        ContentUnavailableView(
            "All clear.",
            systemImage: "checkmark.circle",
            description: Text("Add a task to get started.")
        )
    }
}
```

Place the `.overlay` after `.listStyle(.plain)` on the List.

Use `ContentUnavailableView` (macOS 14+ native component) -- do NOT hand-roll a custom VStack/Text empty state. ContentUnavailableView provides HIG-compliant layout with icon above title above description, automatic accessibility, and proper centering.

The overlay naturally appears over the empty List and disappears when tasks are added, with no additional state management needed -- the @Observable TaskStore drives the `store.tasks.isEmpty` check reactively.
  </action>
  <verify>
- Grep for `ContentUnavailableView` in TaskListView.swift confirms the component is used
- Grep for `All clear` in TaskListView.swift confirms the encouraging message
- Grep for `store.tasks.isEmpty` in TaskListView.swift confirms the conditional check
- Grep for `checkmark.circle` in TaskListView.swift confirms the SF Symbol icon
  </verify>
  <done>
When the task list is empty, a centered "All clear." placeholder with a checkmark icon and "Add a task to get started." description appears. When tasks exist, the overlay is hidden and the list displays normally.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add smooth panel open/close animation</name>
  <files>
    QuickTask/Sources/Panel/FloatingPanel.swift
    QuickTask/Sources/Panel/PanelManager.swift
  </files>
  <action>
**FloatingPanel.swift** -- Add animation behavior in `init()`:

After the existing `hasShadow = true` line (and before `contentView = NSHostingView(...)`), add:
```swift
// Smooth fade animation for show/hide transitions.
// .utilityWindow provides a subtle, native fade appropriate for floating panels.
// macOS applies this automatically when orderFront/orderOut are called.
animationBehavior = .utilityWindow
```

**PanelManager.swift** -- Adjust show/hide for animation compatibility:

In the `show()` method:
- Before `panel.orderFrontRegardless()`, add `panel.alphaValue = 1.0` as a safety reset. This ensures the panel is fully opaque even if a previous hide animation was interrupted (Pitfall 6 from research -- rapid toggle can leave alphaValue stuck at 0).

No other changes needed to PanelManager. The `animationBehavior = .utilityWindow` property causes macOS to automatically animate `orderFront`/`orderOut` calls. If `orderFrontRegardless()` bypasses the animation (research Open Question 3), the fallback is acceptable for v1 -- the panel will still appear/disappear correctly, just without the fade. A manual NSAnimationContext approach can be added in a future iteration if needed.

Do NOT implement the full manual NSAnimationContext alpha animation approach unless `animationBehavior` proves completely non-functional. The simpler approach is preferred for v1.
  </action>
  <verify>
- Grep for `animationBehavior` in FloatingPanel.swift confirms the property is set
- Grep for `utilityWindow` in FloatingPanel.swift confirms the correct animation type
- Grep for `alphaValue = 1.0` in PanelManager.swift confirms the safety reset
  </verify>
  <done>
FloatingPanel has `animationBehavior = .utilityWindow` set in its initializer. PanelManager resets alphaValue to 1.0 before showing. The panel opens and closes with a smooth native fade animation provided by macOS.
  </done>
</task>

</tasks>

<verification>
1. Grep for `ContentUnavailableView` in TaskListView.swift -- confirms empty state component
2. Grep for `animationBehavior` in FloatingPanel.swift -- confirms animation is configured
3. Grep for `alphaValue = 1.0` in PanelManager.swift -- confirms safety reset for animation
4. Verify TaskListView still has `@Environment(TaskStore.self)` -- existing store wiring preserved
5. Verify FloatingPanel still has `.nonactivatingPanel` in style mask -- existing behavior preserved
6. Verify PanelManager still calls `orderFrontRegardless()` and `makeKey()` -- existing show behavior preserved
</verification>

<success_criteria>
- Empty task list shows "All clear." with checkmark icon and description text (not blank space)
- ContentUnavailableView is the component used (not a custom hand-rolled empty state)
- FloatingPanel has animationBehavior = .utilityWindow for smooth transitions
- PanelManager resets alphaValue before showing (guards against interrupted animation)
- All existing panel behavior preserved (floating, non-activating, key window, escape dismiss)
</success_criteria>

<output>
After completion, create `.planning/phases/03-settings-launch-at-login-v1-polish/03-02-SUMMARY.md`
</output>
